<script type="text/javascript">
        var gk_isXlsx = false;
        var gk_xlsxFileLookup = {};
        var gk_fileData = {};
        function filledCell(cell) {
          return cell !== '' && cell != null;
        }
        function loadFileData(filename) {
        if (gk_isXlsx && gk_xlsxFileLookup[filename]) {
            try {
                var workbook = XLSX.read(gk_fileData[filename], { type: 'base64' });
                var firstSheetName = workbook.SheetNames[0];
                var worksheet = workbook.Sheets[firstSheetName];

                // Convert sheet to JSON to filter blank rows
                var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1, blankrows: false, defval: '' });
                // Filter out blank rows (rows where all cells are empty, null, or undefined)
                var filteredData = jsonData.filter(row => row.some(filledCell));

                // Heuristic to find the header row by ignoring rows with fewer filled cells than the next row
                var headerRowIndex = filteredData.findIndex((row, index) =>
                  row.filter(filledCell).length >= filteredData[index + 1]?.filter(filledCell).length
                );
                // Fallback
                if (headerRowIndex === -1 || headerRowIndex > 25) {
                  headerRowIndex = 0;
                }

                // Convert filtered JSON back to CSV
                var csv = XLSX.utils.aoa_to_sheet(filteredData.slice(headerRowIndex)); // Create a new sheet from filtered array of arrays
                csv = XLSX.utils.sheet_to_csv(csv, { header: 1 });
                return csv;
            } catch (e) {
                console.error(e);
                return "";
            }
        }
        return gk_fileData[filename] || "";
        }
        </script><!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>T·∫°o ·∫¢nh N·ªÅn C√° Nh√¢n - ƒêa N·ªÅn T·∫£ng</title>
  <link href="https://fonts.googleapis.com/css2?family=Bangers&display=swap" rel="stylesheet">
  <style>
    * { box-sizing: border-box; }
    body {
      font-family: 'Quicksand', sans-serif;
      background: #f7f9fc;
      margin: 0; padding: 20px;
      display: flex; flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }
    .container {
      background: white;
      max-width: 900px;
      width: 100%;
      padding: 20px;
      border-radius: 16px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.05);
    }
    h1 { text-align: center; color: #333; }
    input, select {
      width: 100%;
      padding: 14px;
      font-size: 16px;
      border: 2px solid #ddd;
      border-radius: 10px;
      outline: none;
      transition: 0.3s;
    }
    input:focus, select:focus { border-color: #3a86ff; }
    .buttons {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
    }
    button {
      padding: 10px 20px;
      font-size: 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      background: #3a86ff;
      color: white;
      transition: background 0.3s;
    }
    button:hover { background: #265bcb; }
    #preview {
      position: relative;
      width: 100%;
      max-width: 800px;
      aspect-ratio: 9 / 16;
      margin: 20px auto;
      border-radius: 16px;
      background-size: cover;
      background-position: center;
      background-image: url('https://res.cloudinary.com/dtsyhqvip/image/upload/v1760605555/backgroundmobile_ltuugb.png');
      overflow: hidden;
      box-shadow: 0 8px 20px rgba(0,0,0,0.15);
    }
    #text-overlay {
      position: absolute;
      top: 55%;
      width: 100%;
      text-align: center;
      font-family: 'Bangers', sans-serif; /* Thay font cho giao di·ªán */
      font-size: 55px;
      color: white;
      text-shadow: 1px 1px 6px rgba(0,0,0,0.6);
      transition: all 0.3s ease;
      padding: 0 10%;
    }
    @media (max-width: 600px) {
      #text-overlay { font-size: 20px; }
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>üñºÔ∏è CHI·∫æN D·ªäCH 120 NG√ÄY T·ªîNG L·ª∞C TI·∫æN C√îNG</h1>
    <input type="text" id="userText" placeholder="Nh·∫≠p m·ª•c ti√™u chi·∫øn minh th·ª±c hi·ªán...">
    <div class="buttons">
      <button onclick="updateText()">üîÑ C·∫≠p nh·∫≠t</button>
      <button onclick="setDevice('desktop')">üì± Xu·∫•t cho ƒêi·ªán tho·∫°i</button>
    </div>
    <div id="preview">
      <div id="text-overlay">N·ªôi dung s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y</div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    function updateText() {
      const text = document.getElementById('userText').value.trim();
      document.getElementById('text-overlay').innerText = text || 'N·ªôi dung s·∫Ω hi·ªÉn th·ªã t·∫°i ƒë√¢y';
    }

    async function setDevice(type) {
      const preview = document.getElementById('preview');
      const originalAspect = preview.style.aspectRatio;

      // Thay ƒë·ªïi t·ªâ l·ªá khung h√¨nh theo lo·∫°i
      preview.style.aspectRatio = '9 / 16';

      // Ch·ªù tr√¨nh duy·ªát c·∫≠p nh·∫≠t layout tr∆∞·ªõc khi ch·ª•p
      await new Promise(r => setTimeout(r, 300));

      html2canvas(preview, { 
        scale: 2,
        useCORS: true // B·∫≠t h·ªó tr·ª£ CORS ƒë·ªÉ x·ª≠ l√Ω ·∫£nh t·ª´ ngu·ªìn b√™n ngo√†i
      }).then(canvas => {
        // T·∫°o URL t·ª´ canvas
        const dataUrl = canvas.toDataURL('image/png');

        // T·∫°o HTML cho tab m·ªõi
        const newWindow = window.open('', '_blank');
        newWindow.document.write(`
          <!DOCTYPE html>
          <html lang="vi">
          <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1">
            <title>·∫¢nh N·ªÅn C√° Nh√¢n</title>
            <style>
              body {
                margin: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                background: #f7f9fc;
              }
              img {
                max-width: 100%;
                max-height: 100vh;
                object-fit: contain;
              }
            </style>
          </head>
          <body>
            <img src="${dataUrl}" alt="·∫¢nh n·ªÅn c√° nh√¢n">
          </body>
          </html>
        `);
        newWindow.document.close();

        // Tr·∫£ l·∫°i t·ªâ l·ªá ban ƒë·∫ßu
        preview.style.aspectRatio = originalAspect;
      }).catch(error => {
        alert('L·ªói khi t·∫°o ·∫£nh: ' + error.message + '. Vui l√≤ng ki·ªÉm tra k·∫øt n·ªëi ho·∫∑c ·∫£nh n·ªÅn!');
      });
    }
  </script>
</body>
</html>
